<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="using:ReMarkableRemember.ViewModels"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
        x:Class="ReMarkableRemember.Views.MainWindow"
        x:DataType="vm:MainWindowModel"
        Icon="/Assets/Logo.ico"
        MinHeight="700"
        MinWidth="1000"
        RenderOptions.BitmapInterpolationMode="HighQuality"
        Title="{Binding Source={x:Static vm:MainWindowModel.Title}}"
        WindowStartupLocation="CenterScreen">

    <Design.DataContext>
        <vm:MainWindowModel/>
    </Design.DataContext>

    <Window.Styles>
        <Style Selector="PathIcon">
            <Setter Property="Height" Value="16"/>
            <Setter Property="Width" Value="16"/>
        </Style>
        <Style Selector="SplitView>Grid.Menu>StackPanel">
            <Setter Property="Margin" Value="8"/>
            <Setter Property="Spacing" Value="8"/>
        </Style>
        <Style Selector="SplitView>Grid.Menu>StackPanel>StackPanel>Button>PathIcon">
            <Setter Property="Margin" Value="4"/>
        </Style>
    </Window.Styles>

    <Window.Resources>
        <StreamGeometry x:Key="MenuBackup">M280-280h400v-80H280v80Zm200-120 160-160-56-56-64 62v-166h-80v166l-64-62-56 56 160 160Zm0 320q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z</StreamGeometry>
        <StreamGeometry x:Key="MenuHandWritingRecognition">M80-720v-200h200v80H160v120H80Zm720 0v-120H680v-80h200v200h-80ZM80-40v-200h80v120h120v80H80Zm600 0v-80h120v-120h80v200H680ZM280-240h400v-480H280v480Zm0 80q-33 0-56.5-23.5T200-240v-480q0-33 23.5-56.5T280-800h400q33 0 56.5 23.5T760-720v480q0 33-23.5 56.5T680-160H280Zm80-400h240v-80H360v80Zm0 120h240v-80H360v80Zm0 120h240v-80H360v80Zm-80 80v-480 480Z</StreamGeometry>
        <StreamGeometry x:Key="MenuInstallLamyEraser">M690-240h190v80H610l80-80Zm-500 80-85-85q-23-23-23.5-57t22.5-58l440-456q23-24 56.5-24t56.5 23l199 199q23 23 23 57t-23 57L520-160H190Zm296-80 314-322-198-198-442 456 64 64h262Zm-6-240Z</StreamGeometry>
        <StreamGeometry x:Key="MenuInstallWebInterfaceOnBoot">M200-120q-17 0-28.5-11.5T160-160v-40h-40v-160q0-17 11.5-28.5T160-400h40v-280q0-66 47-113t113-47q66 0 113 47t47 113v400q0 33 23.5 56.5T600-200q33 0 56.5-23.5T680-280v-280h-40q-17 0-28.5-11.5T600-600v-160h40v-40q0-17 11.5-28.5T680-840h80q17 0 28.5 11.5T800-800v40h40v160q0 17-11.5 28.5T800-560h-40v280q0 66-47 113t-113 47q-66 0-113-47t-47-113v-400q0-33-23.5-56.5T360-760q-33 0-56.5 23.5T280-680v280h40q17 0 28.5 11.5T360-360v160h-40v40q0 17-11.5 28.5T280-120h-80Z</StreamGeometry>
        <StreamGeometry x:Key="MenuOpenItem">M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h280v80H200v560h560v-280h80v280q0 33-23.5 56.5T760-120H200Zm188-212-56-56 372-372H560v-80h280v280h-80v-144L388-332Z</StreamGeometry>
        <StreamGeometry x:Key="MenuManageTemplates">M240-320h360v-200H240v200Zm420-120h60v-200H360v60h300v140ZM160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h640q33 0 56.5 23.5T880-720v480q0 33-23.5 56.5T800-160H160Zm0-80h640v-480H160v480Zm0 0v-480 480Z</StreamGeometry>
        <StreamGeometry x:Key="MenuSyncTargetDirectoryReset">m871-202-71-71v-367H434l-80-80-80-80h114l80 80h332q33 0 56.5 23.5T880-640v400q0 11-2 20.5t-7 17.5ZM819-28 687-160H160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800l80 80h-80v480h447L28-820l56-56L876-84l-57 56ZM368-480Zm209-17Z</StreamGeometry>
        <StreamGeometry x:Key="MenuSyncTargetDirectorySet">m680-80-12-60q-12-5-22.5-10.5T624-164l-58 18-40-68 46-40q-2-12-2-26t2-26l-46-40 40-68 58 18q11-8 21.5-13.5T668-420l12-60h80l12 60q12 5 22.5 10.5T816-396l58-18 40 68-46 40q2 12 2 26t-2 26l46 40-40 68-58-18q-11 8-21.5 13.5T772-140l-12 60h-80Zm40-120q33 0 56.5-23.5T800-280q0-33-23.5-56.5T720-360q-33 0-56.5 23.5T640-280q0 33 23.5 56.5T720-200Zm-560-40v-480 172-12 320Zm0 80q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h240l80 80h320q33 0 56.5 23.5T880-640v131q-18-13-38-22.5T800-548v-92H447l-80-80H160v480h283q3 21 9.5 41t15.5 39H160Z</StreamGeometry>
        <StreamGeometry x:Key="MenuSettings">m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z</StreamGeometry>
        <StreamGeometry x:Key="MenuSync">M160-160v-80h110l-16-14q-52-46-73-105t-21-119q0-111 66.5-197.5T400-790v84q-72 26-116 88.5T240-478q0 45 17 87.5t53 78.5l10 10v-98h80v240H160Zm400-10v-84q72-26 116-88.5T720-482q0-45-17-87.5T650-648l-10-10v98h-80v-240h240v80H690l16 14q49 49 71.5 106.5T800-482q0 111-66.5 197.5T560-170Z</StreamGeometry>
        <StreamGeometry x:Key="MenuUploadFile">M440-200h80v-167l64 64 56-57-160-160-160 160 57 56 63-63v167ZM240-80q-33 0-56.5-23.5T160-160v-640q0-33 23.5-56.5T240-880h320l240 240v480q0 33-23.5 56.5T720-80H240Zm280-520v-200H240v640h480v-440H520ZM240-800v200-200 640-640Z</StreamGeometry>
        <StreamGeometry x:Key="MenuUploadTemplate">M160-240v-480 480Zm80-80v-200h360v200H240Zm-80 160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h640q33 0 56.5 23.5T880-720v240h-80v-240H160v480h360v80H160Zm500-320v-100H360v-60h360v160h-60Zm60 400v-120H600v-80h120v-120h80v120h120v80H800v120h-80Z</StreamGeometry>
        <StreamGeometry x:Key="Spinner">M480-80q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-83 31.5-155.5t86-127Q252-817 325-848.5T480-880q17 0 28.5 11.5T520-840q0 17-11.5 28.5T480-800q-133 0-226.5 93.5T160-480q0 133 93.5 226.5T480-160q133 0 226.5-93.5T800-480q0-17 11.5-28.5T840-520q17 0 28.5 11.5T880-480q0 82-31.5 155t-86 127.5q-54.5 54.5-127 86T480-80Z</StreamGeometry>
        <StreamGeometry x:Key="UsbOff">M791-55 526-320h-6v92q19 10 29.5 28.5T560-160q0 33-23.5 56.5T480-80q-33 0-56.5-23.5T400-160q0-21 11-39t29-29v-92H320q-33 0-56.5-23.5T240-400v-92q-19-10-29.5-28.5T200-560q0-17 6.5-32.5T227-619L55-791l57-57 736 736-57 57Zm-80-308-71-71v-46h-40v-160h160v160h-40v80q0 10-2 19.5t-7 17.5Zm-391-37h120v-6L339-507q-4 5-9 8.5t-10 6.5v92Zm200-154-80-80v-86h-80l120-160 120 160h-80v166Z</StreamGeometry>
        <StreamGeometry x:Key="UsbOn">M480-80q-33 0-56.5-23.5T400-160q0-21 11-39t29-29v-92H320q-33 0-56.5-23.5T240-400v-92q-18-9-29-27t-11-41q0-33 23.5-56.5T280-640q33 0 56.5 23.5T360-560q0 23-11 40t-29 28v92h120v-320h-80l120-160 120 160h-80v320h120v-80h-40v-160h160v160h-40v80q0 33-23.5 56.5T640-320H520v92q19 10 29.5 28t10.5 40q0 33-23.5 56.5T480-80Z</StreamGeometry>
    </Window.Resources>

    <SplitView CompactPaneLength="58" DisplayMode="CompactInline" PanePlacement="Left">
        <SplitView.Pane>
            <Grid Classes="Menu" RowDefinitions="*, Auto">
                <StackPanel Grid.Row="0">
                    <StackPanel ToolTip.Tip="Sync Items">
                        <Button Command="{Binding CommandSync}"><PathIcon Data="{StaticResource MenuSync}"/></Button>
                    </StackPanel>
                    <StackPanel ToolTip.Tip="Backup Items">
                        <Button Command="{Binding CommandBackup}"><PathIcon Data="{StaticResource MenuBackup}"/></Button>
                    </StackPanel>
                    
                    <StackPanel ToolTip.Tip="Set Sync Directory" Margin="0, 16, 0, 0">
                        <Button Command="{Binding CommandSyncTargetDirectory}" CommandParameter="True"><PathIcon Data="{StaticResource MenuSyncTargetDirectorySet}"/></Button>
                    </StackPanel>
                    <StackPanel ToolTip.Tip="Reset Sync Directory">
                        <Button Command="{Binding CommandSyncTargetDirectory}" CommandParameter="False"><PathIcon Data="{StaticResource MenuSyncTargetDirectoryReset}"/></Button>
                    </StackPanel>

                    <StackPanel ToolTip.Tip="Open" Margin="0, 16, 0, 0">
                        <Button Command="{Binding CommandOpenItem}"><PathIcon Data="{StaticResource MenuOpenItem}"/></Button>
                    </StackPanel>
                    <StackPanel ToolTip.Tip="Hand Writing Recognition">
                        <Button Command="{Binding CommandHandWritingRecognition}"><PathIcon Data="{StaticResource MenuHandWritingRecognition}"/></Button>
                    </StackPanel>
                    
                    <StackPanel ToolTip.Tip="Upload File" Margin="0, 16, 0, 0">
                        <Button Command="{Binding CommandUploadFile}"><PathIcon Data="{StaticResource MenuUploadFile}"/></Button>
                    </StackPanel>

                    <StackPanel ToolTip.Tip="Upload Template" Margin="0, 16, 0, 0">
                        <Button Command="{Binding CommandUploadTemplate}"><PathIcon Data="{StaticResource MenuUploadTemplate}"/></Button>
                    </StackPanel>
                    <StackPanel ToolTip.Tip="Manage Templates">
                        <Button Command="{Binding CommandManageTemplates}"><PathIcon Data="{StaticResource MenuManageTemplates}"/></Button>
                    </StackPanel>

                    <StackPanel ToolTip.Tip="Install Lamy Eraser" Margin="0, 16, 0, 0">
                        <Button Command="{Binding CommandInstallLamyEraser}"><PathIcon Data="{StaticResource MenuInstallLamyEraser}"/></Button>
                    </StackPanel>
                    <StackPanel ToolTip.Tip="Install WebInterface-OnBoot">
                        <Button Command="{Binding CommandInstallWebInterfaceOnBoot}"><PathIcon Data="{StaticResource MenuInstallWebInterfaceOnBoot}"/></Button>
                    </StackPanel>
                </StackPanel>

                <StackPanel Grid.Row="1">
                    <StackPanel ToolTip.Tip="Settings">
                        <Button Command="{Binding CommandSettings}"><PathIcon Data="{StaticResource MenuSettings}"/></Button>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </SplitView.Pane>

        <Grid RowDefinitions="*, Auto">
            <TreeDataGrid Grid.Row="0" Source="{Binding ItemsTree}" CanUserResizeColumns="True" CanUserSortColumns="False">
                <TreeDataGrid.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Open" Command="{Binding CommandOpenItem}">
                            <MenuItem.Icon><PathIcon Data="{StaticResource MenuOpenItem}"/></MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Header="Set Sync Directory" Command="{Binding CommandSyncTargetDirectory}" CommandParameter="True">
                            <MenuItem.Icon><PathIcon Data="{StaticResource MenuSyncTargetDirectorySet}"/></MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Reset Sync Directory" Command="{Binding CommandSyncTargetDirectory}" CommandParameter="False">
                            <MenuItem.Icon><PathIcon Data="{StaticResource MenuSyncTargetDirectoryReset}"/></MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Header="Hand Writing Recognition" Command="{Binding CommandHandWritingRecognition}">
                            <MenuItem.Icon><PathIcon Data="{StaticResource MenuHandWritingRecognition}"/></MenuItem.Icon>
                        </MenuItem>
                    </ContextMenu>
                </TreeDataGrid.ContextMenu>
            </TreeDataGrid>

            <DockPanel Grid.Row="1" Margin="8">
                <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" Spacing="4">
                    <PathIcon Data="{StaticResource Spinner}" IsVisible="{Binding JobsText, Converter={x:Static ObjectConverters.IsNotNull}}">
                        <PathIcon.Styles>
                            <Style Selector="PathIcon">
                                <Style.Animations>
                                    <Animation Duration="0:0:3" IterationCount="INFINITE">
                                        <KeyFrame Cue="0%">
                                            <Setter Property="RotateTransform.Angle" Value="0.0"/>
                                        </KeyFrame>
                                        <KeyFrame Cue="100%">
                                            <Setter Property="RotateTransform.Angle" Value="360.0"/>
                                        </KeyFrame>
                                    </Animation>
                                </Style.Animations>
                            </Style>
                        </PathIcon.Styles>
                    </PathIcon>
                    <Label Content="{Binding JobsText}"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" Spacing="2">
                    <PathIcon Data="{StaticResource UsbOn}" IsVisible="{Binding ConnectionStatus, Converter={x:Static ObjectConverters.IsNull}}"/>
                    <PathIcon Data="{StaticResource UsbOff}" IsVisible="{Binding ConnectionStatus, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                    <Label Content="{Binding ConnectionStatusText}"/>
                </StackPanel>
            </DockPanel>
        </Grid>
    </SplitView>
</Window>
